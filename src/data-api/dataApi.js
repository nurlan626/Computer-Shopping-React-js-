export const usersData = [
    {
        id: 1,
        name: "Timur ",
        surname: "Timurov",
        username: "12",
        password: "12",
        tel: "055-898-5555",
        products: [
            {
                id: 1,
                category: "lenova",
                name: "lenovo a3 ultra",
                description: "lenovo laptop for office",
                price: 500,
                new: "yes",
                img: "https://p1-ofp.static.pub/medias/bWFzdGVyfHJvb3R8MjgzOTAxfGltYWdlL3BuZ3xoNTYvaDk5Lzk5MTQ4MzE0MDUwODYucG5nfDdkZTZiMjM3ZTA2YmM5NTc0ZTRjMzcyMDhmZTU5N2NjZjE1NTg0MzhjZjQ2MDU4ODMwMzVmYzAwMmQ2YjU5MDE/lenovo-thinkpad-x390-yoga-hero.png",
                ram: 16,
                cpu: "Intel i7",
                rom: 512,
                romType: "ssd",
                operatingSystem: "Windows",
                videoCard: "Nvidea",
            },
            {
                id: 2,
                category: "acer",
                name: "Acer Aspire 5",
                description: "Affordable Acer laptop",
                price: 450,
                new: "yes",
                img: "https://strgimgr.umico.az/sized/1680/362936-fbf212a2e3e5d6784ce2b864899d9baf.jpg",
                ram: 8,
                cpu: "AMD Ryzen 5",
                rom: 256,
                romType: "ssd",
                operatingSystem: "Windows",
                videoCard: "NVIDIA GeForce MX350",
            },
            {
                id: 3,
                category: "hp",
                name: "HP Pavilion",
                description: "HP laptop for everyday use",
                price: 55,
                new: "yes",
                img: "https://amazoncomp.az/wp-content/uploads/2021/07/1401678_v01_b.jpg",
                ram: 12,
                cpu: "Intel i5",
                rom: 512,
                romType: "ssd",

                operatingSystem: "Windows",
                videoCard: "Intel UHD Graphics",
            },
            {
                id: 4,
                category: "dell",
                name: "Dell Inspiron",
                description: "Dell laptop with a touchscreen",
                price: 700,
                new: "yes",
                img: "https://www.bakuelectronics.az/assets/images/products/92883/ezgifcom-gif-maker-1.jpg",
                ram: 16,
                cpu: "Intel i7",
                rom: 512,
                romType: "ssd",

                operatingSystem: "Windows",
                videoCard: "NVIDIA GeForce GTX 1650",
            },
            {
                id: 5,
                category: "asus",
                name: "Asus ROG Zephyrus",
                description: "Gaming laptop with high performance",
                price: 1200,
                new: "yes",
                img: "https://amazoncomp.az/wp-content/uploads/2023/06/ASUS-ROG-Zephyrus-M16-GU603-1.jpg",
                ram: 32,
                cpu: "AMD Ryzen 9",
                rom: 256,
                romType: "ssd",

                operatingSystem: "Windows",
                videoCard: "NVIDIA GeForce RTX 3080",
            },
        ],
    },
    {
        id: 2,
        name: "Timur ",
        surname: "Timurov",
        username: "user2",
        password: "123",
        tel: "070-999-5465",
        products: [
            {
                id: 5,
                category: "hp",
                name: "HP Envy x360",
                description: "HP 2-in-1 laptop",
                price: 800,
                new: "yes",
                img: "https://irshad.az/cdn-cgi/image/width=540,height=550/storage/products/83215/hp-envy-x360-laptop-15-ew0005ci-6j5l5ea-12.jpg",
                ram: 12,
                cpu: "AMD Ryzen 7",
                rom: 512,
                romType: "ssd",

                operatingSystem: "Windows",
                videoCard: "AMD Radeon Graphics",
            },
            {
                id: 6,
                category: "asus",
                name: "Asus ROG Strix G15",
                description: "Gaming laptop with high performance",
                price: 1200,
                new: "yes",
                img: "https://amazoncomp.az/wp-content/uploads/2020/11/3-4-scaled-e1585829325535-1.jpg",
                ram: 32,
                cpu: "Intel i9",
                rom: 256,
                romType: "ssd",

                operatingSystem: "Windows",
                videoCard: "Nvidia GeForce RTX 3080",
            },
        ],
    },
    {
        id: 3,
        name: "Timur ",
        surname: "Timurov",
        username: "user3",
        password: "123",
        tel: "055-989-7788",
        products: [
            {
                id: 7,
                category: "apple",
                name: "MacBook Air",
                description: "Apple's thin and light laptop",
                price: 1000,
                new: "yes",
                img: "https://cdn1.it4profit.com/AfrOrF3gWeDA6VOlDG4TzxMv39O7MXnF4CXpKUwGqRM/resize:fill:540/bg:f6f6f6/q:100/plain/s3://catalog-products/230606070527269121/230607070019091158.png@webp",
                ram: 8,
                cpu: "Apple M1",
                rom: 512,
                romType: "ssd",

                operatingSystem: "macOS",
                videoCard: "Apple GPU",
            },
        ],
    },
    {
        id: 4,
        name: "Timur ",
        surname: "Timurov",
        username: "user4",
        password: "123",
        tel: "051-986-9966",
        products: [
            {
                id: 8,
                category: "hp",
                name: "HP Pavilion x360",
                description: "HP 2-in-1 laptop with touchscreen",
                price: 750,
                new: "yes",
                img: "https://cdn.irshad.az/products/88816/6l9p8ea-1.jpg?width=1400",
                ram: 16,
                cpu: "Intel i7",
                rom: 512,
                romType: "ssd",

                operatingSystem: "Windows",
                videoCard: "Intel Iris Xe Graphics",
            },
            {
                id: 9,
                category: "acer",
                name: "Acer Predator Helios 300",
                description: "High-performance gaming laptop",
                price: 1100,
                new: "yes",
                img: "https://kontakt.az/media/catalog/product/cache/b34559cb8eb520f2bea0d3245ba154fd/n/e/new_project_88__12.png",
                ram: 32,
                cpu: "Intel i7",
                rom: 512,
                romType: "ssd",

                operatingSystem: "Windows",
                videoCard: "Nvidia GeForce RTX 3060",
            },
            {
                id: 10,
                category: "lenova",
                name: "Lenovo Legion 5",
                description: "Gaming laptop with AMD Ryzen",
                price: 900,
                new: "yes",
                img: "https://amazoncomp.az/wp-content/uploads/2021/05/Lenovo_Legion_5_15ARH05_CT2_01-1.png",
                ram: 16,
                cpu: "AMD Ryzen 7",
                rom: 512,
                romType: "ssd",

                operatingSystem: "Windows",
                videoCard: "Nvidia GeForce GTX 1660 Ti",
            },
            {
                id: 11,
                category: "asus",
                name: "Asus VivoBook S15",
                description: "Slim and stylish laptop",
                price: 800,
                new: "yes",
                img: "https://static.insales-cdn.com/images/products/1/748/462332652/1000-29-4.jpg",
                ram: 8,
                cpu: "Intel i5",
                rom: 512,
                romType: "ssd",

                operatingSystem: "Windows",
                videoCard: "Intel UHD Graphics",
            },
            {
                id: 12,
                category: "apple",
                name: "MacBook Pro 16",
                description: "Apple's powerful laptop",
                price: 2400,
                new: "yes",
                img: "https://strgimgr.umico.az/sized/1680/22970-0f8a71f8a16c6d74e78445934601a015.jpg",
                ram: 32,
                cpu: "Intel i9",
                rom: 512,
                romType: "ssd",

                operatingSystem: "macOS",
                videoCard: "AMD Radeon Pro 5500M",
            },
        ],
    },
    {
        id: 5,
        name: "Timur ",
        surname: "Timurov",
        password: "123",
        tel: "070-988-9999",
        products: [
            {
                id: 13,
                category: "dell",
                name: "Dell XPS 13",
                description: "Dell ultrabook",
                price: 900,
                new: "yes",
                img: "https://www.mgstore.az/image/catalog/products/Komputer%20texnikasi/Notebook/Dell%20XPS%2013%209381.jpg",
                ram: 16,
                cpu: "Intel i7",
                rom: 512,
                romType: "ssd",

                operatingSystem: "Windows",
                videoCard: "Intel Iris Xe Graphics",
            },
            {
                id: 14,
                category: "macbook",
                name: "MacBook Pro 13",
                description: "Apple's professional laptop",
                price: 1500,
                new: "yes",
                img: "https://cdn1.it4profit.com/AfrOrF3gWeDA6VOlDG4TzxMv39O7MXnF4CXpKUwGqRM/resize:fill:540/bg:f6f6f6/q:100/plain/s3://catalog-products/220607122712762177/220831140016734479.png@webp",
                ram: 16,
                cpu: "Apple M1",
                rom: 512,
                romType: "ssd",

                operatingSystem: "macOS",
                videoCard: "Apple GPU",
            },
        ],
    },
    {
        id: 6,
        name: "Timur ",
        surname: "Timurov",
        username: "user6",
        password: "123",
        tel: "050-951-8888",
        products: [
            {
                id: 15,
                category: "lenova",
                name: "Lenovo ThinkPad X1 Carbon",
                description: "Lenovo business laptop",
                price: 1200,
                new: "yes",
                img: "https://bestel.az/storage/28547/conversions/media-library2HckfP-lg.jpg",
                ram: 16,
                cpu: "Intel i7",
                rom: 512,
                romType: "ssd",

                operatingSystem: "Windows",
                videoCard: "Intel Iris Xe Graphics",
            },
            {
                id: 16,
                category: "asus",
                name: "Asus ZenBook 14",
                description: "Slim and lightweight laptop",
                price: 800,
                new: "yes",
                img: "https://irshad.b-cdn.net/products/87350/asus-zenbook-14-um3402ya-kp601-90nb0w95-m010z0-1-1.jpg?width=1400",
                ram: 8,
                cpu: "Intel i5",
                rom: 512,
                romType: "ssd",

                operatingSystem: "Windows",
                videoCard: "Intel UHD Graphics",
            },
        ],
    },
    {
        id: 7,
        name: "Timur ",
        surname: "Timurov",
        username: "user7",
        password: "123",
        tel: "050-888-9999",
        products: [
            {
                id: 17,
                category: "acer",
                name: "Acer Aspire 7",
                description: "Affordable Acer laptop with a large display",
                price: 600,
                new: "yes",
                img: "https://strgimgr.umico.az/sized/840/564167-8e6a8a310e462c660353bc57dd071d18.jpg",
                ram: 16,
                cpu: "Intel i5",
                rom: 512,
                romType: "ssd",

                operatingSystem: "Windows",
                videoCard: "NVIDIA GeForce GTX 1650 Ti",
            },
        ],
    },
    {
        id: 8,
        name: "Timur ",
        surname: "Timurov",
        username: "user8",
        password: "123",
        tel: "070-999-8877",
        products: [
            {
                id: 18,
                category: "hp",
                name: "HP Envy 15",
                description: "HP laptop with a premium design and powerful performance",
                price: 1200,
                new: "yes",
                img: "https://www.bakinity.biz/upload/iblock/7e7/7e78a8392d25da057699ee3157586203.jpg",
                ram: 32,
                cpu: "Intel i7",
                rom: 512,
                romType: "ssd",

                operatingSystem: "Windows",
                videoCard: "NVIDIA GeForce RTX 3070",
            },
        ],
    },
    {
        id: 9,
        name: "Timur ",
        surname: "Timurov",
        username: "user9",
        password: "123",
        tel: "055-887-9966",
        products: [
            {
                id: 9,
                category: "dell",
                name: "Dell Latitude 7430",
                description:
                    "Dell business laptop with a long battery life and security features",
                price: 1500,
                new: "yes",
                img: "https://i.dell.com/is/image/DellContent/content/dam/ss2/product-images/dell-client-products/notebooks/latitude-notebooks/14-7430/media-gallery/notebook-latitude-14-7430-t-gray-gallery-2.psd?fmt=png-alpha&pscan=auto&scl=1&hei=402&wid=536&qlt=100,1&resMode=sharp2&size=536,402&chrss=full",
                ram: 16,
                cpu: "Intel i7 vPro",
                rom: 512,
                romType: "ssd",

                operatingSystem: "Windows",
                videoCard: "Intel Iris Xe Graphics",
            },
        ],
    },
    {
        id: 10,
        name: "Timur ",
        surname: "Timurov",
        username: "user10",
        password: "123",
        tel: "070-951-5555",
        products: [
            {
                id: 20,
                category: "apple",
                name: "MacBook Air M2",
                description:
                    "Apple's latest MacBook Air with a powerful M2 chip and long battery life",
                price: 1200,
                new: "yes",
                img: "https://cdn1.it4profit.com/AfrOrF3gWeDA6VOlDG4TzxMv39O7MXnF4CXpKUwGqRM/resize:fill:540/bg:f6f6f6/q:100/plain/s3://catalog-products/220607122234122641/220831140040449699.png@webp",
                ram: 16,
                cpu: "Apple M2",
                rom: 512,
                romType: "ssd",
                operatingSystem: "macOS",
                videoCard: "Apple GPU",
            },
        ],
    },
];



export function initData() {
    // Проверяем, существует ли массив users в localStorage
    let users = JSON.parse(localStorage.getItem("users"));
    // Если массив пользователей отсутствует, инициализируем его
    if (!users) {
        localStorage.clear();
        localStorage.setItem("userId", null);
        localStorage.setItem("users", JSON.stringify(usersData));
    }
}
export function registrateUser(newUser) {
    // Генерация случайного идентификатора для нового пользователя
    const newUserWithId = {
        id: Math.random(),
        ...newUser
    };

    // Извлечение пользователей из localStorage или установка пустого массива, если пользователей нет
    const users = JSON.parse(localStorage.getItem("users")) || [];

    // Добавление нового пользователя к существующим пользователям
    const newUsers = [...users, newUserWithId];

    // Сохранение обновленного списка пользователей в localStorage
    localStorage.setItem('users', JSON.stringify(newUsers));
}
export function logInUser(formData) {
    // Получаем список пользователей из localStorage
    const users = JSON.parse(localStorage.getItem("users")) || [];

    // Находим пользователя по имени и паролю
    const user = users.find(item =>
        item.username === formData.username && item.password === formData.password
    );
    if (user) {
        // Сохраняем ID пользователя в localStorage
        localStorage.setItem('userId', user.id);
        // Возвращаем найденного пользователя
        return user;
    } else {
        // Возвращаем false, если пользователь не найден
        return false;
    }
}



export function logOut() {
    localStorage.setItem("userId", null)

}

export function getAllProducts() {
    // Извлекаем пользователей из localStorage или используем пустой массив, если пользователей нет
    const users = JSON.parse(localStorage.getItem('users')) || [];

    // Объединяем все продукты от всех пользователей в один массив
    const allProducts = users.reduce((acc, user) => {
        // Проверяем, есть ли у пользователя продукты
        if (user.products && Array.isArray(user.products)) {
            return [...acc, ...user.products];
        }
        return acc;
    }, []);

    return allProducts;
}
export function getAllBrands() {
    const allProducts = getAllProducts();

    if (!Array.isArray(allProducts)) {
        console.error('getAllProducts() должен возвращать массив продуктов');
        return [];
    }
    let allBrands = allProducts.map(product => product.category.toLowerCase());

    // Удаляем дублирующиеся элементы с помощью Set
    allBrands = [...new Set(allBrands)];
    console.log(allBrands);
    return allBrands;

}


export function getUserData() {
    // Получаем userId из localStorage и преобразуем в число
    const userId = JSON.parse(localStorage.getItem("userId"));
    // Получаем список пользователей из localStorage
    const users = JSON.parse(localStorage.getItem("users"));

    // Проверка наличия userId
    if (!userId) {
        console.error('userId не найден в localStorage');
        return null;
    }

    // Проверка наличия users
    if (!users) {
        console.error('users не найдены в localStorage');
        return null;
    }

    // Проверка, является ли users массивом
    if (!Array.isArray(users)) {
        console.error('Неправильный формат данных users в localStorage');
        return null;
    }

    // Поиск пользователя по userId
    const user = users.find(user => user.id === userId);

    // Проверка наличия пользователя
    if (!user) {
        console.warn(`Пользователь с id: ${userId} не найден`);
        return null;
    }

    console.log('Найден пользователь:', user);

    // Возвращаем найденного пользователя
    return user;
}




export function deleteProductFromDatabase(userId, productId) {
    // Получаем список пользователей из localStorage
    let users = JSON.parse(localStorage.getItem("users")) || [];

    // Находим пользователя по userId
    const userIndex = users.findIndex(user => user.id === userId);

    if (userIndex !== -1) {
        // Находим индекс продукта у найденного пользователя
        const productIndex = users[userIndex].products.findIndex(product => product.id === productId);

        if (productIndex !== -1) {
            // Удаляем продукт из массива у найденного пользователя
            users[userIndex].products.splice(productIndex, 1);

            // Обновляем localStorage с обновленным массивом пользователей
            localStorage.setItem('users', JSON.stringify(users));

            // Возвращаем обновленного пользователя (необязательно, зависит от требований)
            return users[userIndex];
        } else {
            console.error(`Продукт с id ${productId} не найден у пользователя с id ${userId}`);
            return null; // Возвращаем null, если продукт не найден у пользователя
        }
    } else {
        console.error(`Пользователь с id ${userId} не найден в localStorage`);
        return null; // Возвращаем null, если пользователь не найден
    }
}

export function addNewProductToDatabase(user, newProduct) {
    // Получаем список пользователей из localStorage
    let users = JSON.parse(localStorage.getItem("users")) || [];

    // Находим индекс пользователя по его id
    const userIndex = users.findIndex(item => item.id === user.id);

    if (userIndex !== -1) {
        // Обновляем список продуктов пользователя
        users[userIndex].products = [...users[userIndex].products, newProduct];
        // Обновляем localStorage с обновленным массивом пользователей
        localStorage.setItem('users', JSON.stringify(users));
        // Возвращаем обновленного пользователя
        return users[userIndex];
    } else {
        console.error(`Пользователь с id ${user.id} не найден в localStorage`);
        return null; // Возвращаем null, если пользователь не найден
    }
}


export function editProductFromDatabase(user, updatedProducts) {
    // Создаем обновленного пользователя с обновленным списком продуктов
    const updatedUser = { ...user, products: [...updatedProducts] };
    // Получаем список пользователей из localStorage
    let users = JSON.parse(localStorage.getItem("users")) || [];

    // Находим индекс пользователя по его id
    const userIndex = users.findIndex(item => item.id === user.id);

    if (userIndex !== -1) {
        // Обновляем пользователя в массиве пользователей
        users[userIndex] = updatedUser;
        // Обновляем localStorage с обновленным массивом пользователей
        localStorage.setItem('users', JSON.stringify(users));
        // Возвращаем обновленного пользователя
        return users[userIndex];
    } else {
        console.error(`Пользователь с id ${user.id} не найден в localStorage`);
        return null; // Возвращаем null, если пользователь не найден
    }
}


